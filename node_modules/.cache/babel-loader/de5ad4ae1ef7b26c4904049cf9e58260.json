{"ast":null,"code":"import { createElementVNode as _createElementVNode, vModelText as _vModelText, withKeys as _withKeys, withDirectives as _withDirectives, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, renderList as _renderList, Fragment as _Fragment, toDisplayString as _toDisplayString, normalizeClass as _normalizeClass, createBlock as _createBlock } from \"vue\";\nconst _hoisted_1 = {\n  class: \"d-flex justify-content-between mb-3\"\n};\n\nconst _hoisted_2 = /*#__PURE__*/_createElementVNode(\"h2\", null, \"To-Do List\", -1\n/* HOISTED */\n);\n\nconst _hoisted_3 = /*#__PURE__*/_createElementVNode(\"hr\", null, null, -1\n/* HOISTED */\n);\n\nconst _hoisted_4 = {\n  key: 0\n};\n\nconst _hoisted_5 = /*#__PURE__*/_createElementVNode(\"hr\", null, null, -1\n/* HOISTED */\n);\n\nconst _hoisted_6 = {\n  \"aria-label\": \"Page navigation example\"\n};\nconst _hoisted_7 = {\n  class: \"pagination\"\n};\nconst _hoisted_8 = {\n  key: 0,\n  class: \"page-item\"\n};\nconst _hoisted_9 = [\"onClick\"];\nconst _hoisted_10 = {\n  key: 1,\n  class: \"page-item\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_TodoList = _resolveComponent(\"TodoList\");\n\n  const _component_Toast = _resolveComponent(\"Toast\");\n\n  return _openBlock(), _createElementBlock(_Fragment, null, [_createElementVNode(\"div\", null, [_createElementVNode(\"div\", _hoisted_1, [_hoisted_2, _createElementVNode(\"button\", {\n    class: \"btn btn-primary\",\n    onClick: _cache[0] || (_cache[0] = (...args) => $setup.moveToCreatePage && $setup.moveToCreatePage(...args))\n  }, \" Create Todo \")]), _withDirectives(_createElementVNode(\"input\", {\n    class: \"form-control\",\n    type: \"text\",\n    \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => $setup.searchText = $event),\n    placeholder: \"Search\",\n    onKeyup: _cache[2] || (_cache[2] = _withKeys((...args) => $setup.searchTodo && $setup.searchTodo(...args), [\"enter\"]))\n  }, null, 544\n  /* HYDRATE_EVENTS, NEED_PATCH */\n  ), [[_vModelText, $setup.searchText]]), _hoisted_3, !$setup.todos.length ? (_openBlock(), _createElementBlock(\"div\", _hoisted_4, \" There is nothing to display \")) : _createCommentVNode(\"v-if\", true), _createVNode(_component_TodoList, {\n    todos: $setup.todos,\n    onToggleTodo: $setup.toggleTodo,\n    onDeleteTodo: $setup.deleteTodo\n  }, null, 8\n  /* PROPS */\n  , [\"todos\", \"onToggleTodo\", \"onDeleteTodo\"]), _hoisted_5, _createElementVNode(\"nav\", _hoisted_6, [_createElementVNode(\"ul\", _hoisted_7, [$setup.currentPage !== 1 ? (_openBlock(), _createElementBlock(\"li\", _hoisted_8, [_createElementVNode(\"a\", {\n    style: {\n      \"cursor\": \"pointer\"\n    },\n    class: \"page-link\",\n    onClick: _cache[3] || (_cache[3] = $event => $setup.getTodos($setup.currentPage - 1))\n  }, \" Previous \")])) : _createCommentVNode(\"v-if\", true), (_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.numberOfPages, page => {\n    return _openBlock(), _createElementBlock(\"li\", {\n      key: page,\n      class: _normalizeClass([\"page-item\", $setup.currentPage === page ? 'active' : ''])\n    }, [_createElementVNode(\"a\", {\n      style: {\n        \"cursor\": \"pointer\"\n      },\n      class: \"page-link\",\n      onClick: $event => $setup.getTodos(page)\n    }, _toDisplayString(page), 9\n    /* TEXT, PROPS */\n    , _hoisted_9)], 2\n    /* CLASS */\n    );\n  }), 128\n  /* KEYED_FRAGMENT */\n  )), $setup.numberOfPages !== $setup.currentPage ? (_openBlock(), _createElementBlock(\"li\", _hoisted_10, [_createElementVNode(\"a\", {\n    style: {\n      \"cursor\": \"pointer\"\n    },\n    class: \"page-link\",\n    onClick: _cache[4] || (_cache[4] = $event => $setup.getTodos($setup.currentPage + 1))\n  }, \"Next\")])) : _createCommentVNode(\"v-if\", true)])])]), $setup.showToast ? (_openBlock(), _createBlock(_component_Toast, {\n    key: 0,\n    message: $setup.toastMessage,\n    type: $setup.toastAlertType\n  }, null, 8\n  /* PROPS */\n  , [\"message\", \"type\"])) : _createCommentVNode(\"v-if\", true)], 64\n  /* STABLE_FRAGMENT */\n  );\n}","map":{"version":3,"mappings":";;AAESA,OAAK,EAAC;;;gCACTC,oBAAmB,IAAnB,EAAmB,IAAnB,EAAI,YAAJ,EAAc;AAAA;AAAd;;gCAgBFA,oBAAM,IAAN,EAAM,IAAN,EAAM,IAAN,EAAM;AAAA;AAAN;;;;;;gCAUAA,oBAAM,IAAN,EAAM,IAAN,EAAM,IAAN,EAAM;AAAA;AAAN;;;AACK,gBAAW;;;AACVD,OAAK,EAAC;;;;AACqBA,OAAK,EAAC;;;;;AAaMA,OAAK,EAAC;;;;;;;6DA5CrDC,oBAiDM,KAjDN,EAiDM,IAjDN,EAiDM,CAhDJA,oBAQM,KARN,cAQM,CAPJC,UAOI,EANJD,oBAKS,QALT,EAKS;AAJPD,SAAK,EAAC,iBAIC;AAHNG,WAAK,yCAAEC,2DAAF;AAGC,GALT,EAGC,eAHD,CAMI,CARN,CAgDI,kBAtCJH,oBAMC,OAND,EAMC;AALCD,SAAK,EAAC,cAKP;AAJCK,QAAI,EAAC,MAIN;+DAHUD,oBAAUE,OAGpB;AAFCC,eAAW,EAAC,QAEb;AADEC,WAAK,mDAAQJ,+CAAR,EAAkB,SAAlB;AACP,GAND;;AAAA,oBAGWA,oBAmCP,EA/BJK,UA+BI,GA7BQL,aAAMM,wBAAlBC,oBAEM,KAFN,EAEMC,UAFN,EAA0B,+BAA1B,sCA6BI,EA1BJC,aAIEC,mBAJF,EAIE;AAHCC,SAAK,EAAEX,YAGR;AAFCY,gBAAW,EAAEZ,iBAEd;AADCa,gBAAW,EAAEb;AACd,GAJF;;AAAA,8CA0BI,EArBJc,UAqBI,EApBJjB,oBAmBM,KAnBN,cAmBM,CAlBJA,oBAiBK,IAjBL,cAiBK,CAhBOG,uBAAW,mBAArBO,oBAIK,IAJL,cAIK,CAHHV,oBAEI,GAFJ,EAEI;AAFDkB,SAAuB,EAAvB;AAAA;AAAA,KAEC;AAFuBnB,SAAK,EAAC,WAE7B;AAF0CG,WAAK,sCAAEC,gBAASA,qBAAW,CAApB,CAAF;AAE/C,GAFJ,EAAgF,YAAhF,CAGG,CAJL,sCAgBG,qBAXHO,oBAOKS,SAPL,EAOK,IAPL,EAOKC,YANYjB,oBAMZ,EANIkB,IAAqB,IAAjB;yBADbX,oBAOK,IAPL,EAOK;AALFY,SAAG,EAAED,IAKH;AAJHtB,WAAK,mBAAC,WAAD,EACGI,uBAAgBkB,IAAhB,GAAoB,QAApB,GAAoB,EADvB;AAIF,KAPL,GAMErB,oBAAiF,GAAjF,EAAiF;AAA9EkB,WAAuB,EAAvB;AAAA;AAAA,OAA8E;AAAtDnB,WAAK,EAAC,WAAgD;AAAnCG,aAAK,YAAEC,gBAASkB,IAAT;AAA4B,KAAjF,mBAAuEA,KAAvE,EAA2E;AAAA;AAA3E,MAA2EE,UAA3E,EANF;;AAAA;GAOK,CAPL;;AAAA,GAWG,GAHOpB,yBAAkBA,oCAA5BO,oBAEK,IAFL,eAEK,CADHV,oBAAwF,GAAxF,EAAwF;AAArFkB,SAAuB,EAAvB;AAAA;AAAA,KAAqF;AAA7DnB,SAAK,EAAC,WAAuD;AAA1CG,WAAK,sCAAEC,gBAASA,qBAAW,CAApB,CAAF;AAAqC,GAAxF,EAAgF,MAAhF,CACG,CAFL,sCAGG,CAjBL,CAkBI,CAnBN,CAoBI,CAjDN,GAmDQA,kCADRqB,aAIEC,gBAJF,EAIE;UAAA;AAFCC,WAAO,EAAEvB,mBAEV;AADCC,QAAI,EAAED;AACP,GAJF;;AAAA","names":["class","_createElementVNode","_hoisted_2","onClick","$setup","type","$event","placeholder","onKeyup","_hoisted_3","length","_createElementBlock","_hoisted_4","_createVNode","_component_TodoList","todos","onToggleTodo","onDeleteTodo","_hoisted_5","style","_Fragment","_renderList","page","key","_hoisted_9","_createBlock","_component_Toast","message"],"sourceRoot":"","sources":["/Applications/kdh3543/vue_practice1/src/pages/todos/index.vue"],"sourcesContent":["<template>\n  <div>\n    <div class=\"d-flex justify-content-between mb-3\">\n      <h2>To-Do List</h2>\n      <button \n        class=\"btn btn-primary\"\n        @click=\"moveToCreatePage\"\n      >\n        Create Todo\n      </button>\n    </div>\n    \n    <input\n      class=\"form-control\"\n      type=\"text\" \n      v-model=\"searchText\"\n      placeholder=\"Search\"\n      @keyup.enter=\"searchTodo\"\n    >\n    <hr />\n    \n    <div v-if=\"!todos.length\">\n      There is nothing to display\n    </div>\n    <TodoList \n      :todos=\"todos\" \n      @toggle-todo=\"toggleTodo\"\n      @delete-todo=\"deleteTodo\"\n    />\n    <hr />\n    <nav aria-label=\"Page navigation example\">\n      <ul class=\"pagination\">\n        <li v-if=\"currentPage !== 1\" class=\"page-item\">\n          <a style=\"cursor: pointer\" class=\"page-link\" @click=\"getTodos(currentPage - 1)\">\n            Previous\n          </a>\n        </li>\n        <li\n          v-for=\"page in numberOfPages\"\n          :key=\"page\" \n          class=\"page-item\"\n          :class=\"currentPage === page ? 'active' : ''\"\n        >\n          <a style=\"cursor: pointer\" class=\"page-link\" @click=\"getTodos(page)\">{{page}}</a>\n        </li>\n        <li v-if=\"numberOfPages !== currentPage\" class=\"page-item\">\n          <a style=\"cursor: pointer\" class=\"page-link\" @click=\"getTodos(currentPage + 1)\">Next</a>\n        </li>\n      </ul>\n    </nav>\n  </div>\n  <Toast \n    v-if=\"showToast\" \n    :message=\"toastMessage\"\n    :type=\"toastAlertType\"\n  />\n</template>\n\n<script>\nimport { ref, computed, watch } from 'vue';\nimport TodoList from '@/components/TodoList.vue';\nimport axios from 'axios';\nimport Toast from '@/components/Toast.vue';\nimport { useToast } from '@/composables/toast';\nimport {useRouter} from 'vue-router';\n\nexport default {\n  components: {\n    TodoList,\n    Toast,\n  },\n  setup() {\n    const router = useRouter();\n    const todos = ref([]);\n    const error = ref('');\n    const numberOfTodos = ref(0);\n    let limit = 5;\n    const currentPage = ref(1);\n    const searchText = ref('');\n    const numberOfPages = computed(() => {\n      return Math.ceil(numberOfTodos.value/limit);\n    });\n\n    const {\n      toastMessage,\n      toastAlertType,\n      showToast,\n      triggerToast\n    } = useToast();\n\n    const getTodos = async (page = currentPage.value) => {\n      currentPage.value = page;\n      try {\n        const res = await axios.get(\n          `http://localhost:3000/todos?_sort=id&_order=desc&subject_like=${searchText.value}&_page=${page}&_limit=${limit}`\n        );\n        numberOfTodos.value = res.headers['x-total-count'];\n        todos.value = res.data;\n      } catch (err) {\n        console.log(err);\n        error.value = 'Something went wrong.';\n        triggerToast('Something went wrong', 'danger')\n      }    \n    };\n\n    getTodos();\n\n    const addTodo = async (todo) => {\n      // 데이터베이스 투두를 저장\n      error.value = '';\n      try {\n        await axios.post('http://localhost:3000/todos', {\n          subject: todo.subject,\n          completed: todo.completed,\n        });\n\n        getTodos(1);\n      } catch (err) {\n        console.log(err);\n        error.value = 'Something went wrong.';\n        triggerToast('Something went wrong', 'danger')\n      }\n    };\n\n    const deleteTodo = async (id) => {\n      error.value = '';\n    \n      try {\n        await axios.delete('http://localhost:3000/todos/' + id);\n        \n        getTodos(1);\n      } catch (err) {\n        console.log(err);\n        error.value = 'Something went wrong.';\n        triggerToast('Something went wrong', 'danger')\n      }\n    };\n\n    const toggleTodo = async (index, checked) => {\n      error.value = '';\n      const id = todos.value[index].id;\n      try {\n        await axios.patch('http://localhost:3000/todos/' + id, {\n          completed: checked\n        });\n\n        todos.value[index].completed = checked\n      } catch (err) {\n        console.log(err);\n        error.value = 'Something went wrong.';\n        triggerToast('Something went wrong', 'danger')\n      }\n      \n    };\n\n    const moveToCreatePage = () => {\n      router.push({\n        name: 'TodoCreate',\n      })\n    };\n\n    let timeout = null;\n    const searchTodo = () => {\n      clearTimeout(timeout);\n      getTodos(1);\n    };\n\n    watch(searchText, () => {\n      clearTimeout(timeout);\n      timeout = setTimeout(() => {\n        getTodos(1);\n      }, 2000);     \n    });\n\n    return {\n      searchTodo,\n      todos,\n      addTodo,\n      deleteTodo,\n      toggleTodo,\n      searchText,\n      error,\n      numberOfPages,\n      currentPage,\n      getTodos,\n      toastMessage,\n      toastAlertType,\n      showToast,\n      moveToCreatePage,\n    };\n  }\n}\n</script>\n\n<style>\n  .todo {\n    color: gray;\n    text-decoration: line-through;\n  }\n</style>"]},"metadata":{},"sourceType":"module"}