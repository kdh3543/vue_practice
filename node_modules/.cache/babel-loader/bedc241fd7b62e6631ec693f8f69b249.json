{"ast":null,"code":"import { createElementVNode as _createElementVNode, vModelText as _vModelText, withKeys as _withKeys, withDirectives as _withDirectives, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, renderList as _renderList, Fragment as _Fragment, toDisplayString as _toDisplayString, normalizeClass as _normalizeClass, createBlock as _createBlock, Transition as _Transition, withCtx as _withCtx, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-3e721a5c\"), n = n(), _popScopeId(), n);\n\nconst _hoisted_1 = {\n  class: \"d-flex justify-content-between mb-3\"\n};\n\nconst _hoisted_2 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"h1\", null, \"To-Do List\", -1\n/* HOISTED */\n));\n\nconst _hoisted_3 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"hr\", null, null, -1\n/* HOISTED */\n));\n\nconst _hoisted_4 = {\n  key: 0\n};\n\nconst _hoisted_5 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"hr\", null, null, -1\n/* HOISTED */\n));\n\nconst _hoisted_6 = {\n  \"aria-label\": \"Page navigation example\"\n};\nconst _hoisted_7 = {\n  class: \"pagination\"\n};\nconst _hoisted_8 = {\n  class: \"page-item\"\n};\nconst _hoisted_9 = [\"onClick\"];\nconst _hoisted_10 = {\n  class: \"page-item\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_TodoList = _resolveComponent(\"TodoList\");\n\n  const _component_Toast = _resolveComponent(\"Toast\");\n\n  return _openBlock(), _createElementBlock(\"div\", null, [_createElementVNode(\"div\", _hoisted_1, [_hoisted_2, _createElementVNode(\"button\", {\n    class: \"btn btn-primary\",\n    onClick: _cache[0] || (_cache[0] = (...args) => $setup.moveToCreate && $setup.moveToCreate(...args))\n  }, \"Create Todo\")]), _withDirectives(_createElementVNode(\"input\", {\n    class: \"form-control\",\n    type: \"text\",\n    \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => $setup.searchText = $event),\n    placeholder: \"search\",\n    onKeyup: _cache[2] || (_cache[2] = _withKeys((...args) => $setup.searchClear && $setup.searchClear(...args), [\"enter\"]))\n  }, null, 544\n  /* HYDRATE_EVENTS, NEED_PATCH */\n  ), [[_vModelText, $setup.searchText]]), _hoisted_3, !$setup.todos.length ? (_openBlock(), _createElementBlock(\"div\", _hoisted_4, \" There is nothing \")) : _createCommentVNode(\"v-if\", true), _createVNode(_component_TodoList, {\n    todos: $setup.todos,\n    onToggleTodo: $setup.toggleTodo,\n    onDeleteTodo: $setup.deleteTodo\n  }, null, 8\n  /* PROPS */\n  , [\"todos\", \"onToggleTodo\", \"onDeleteTodo\"]), _hoisted_5, _createElementVNode(\"nav\", _hoisted_6, [_createElementVNode(\"ul\", _hoisted_7, [_createElementVNode(\"li\", _hoisted_8, [$setup.currentPage != 1 ? (_openBlock(), _createElementBlock(\"a\", {\n    key: 0,\n    class: \"page-link\",\n    href: \"#\",\n    onClick: _cache[3] || (_cache[3] = $event => $setup.getTodos($setup.currentPage - 1))\n  }, \"Previous\")) : _createCommentVNode(\"v-if\", true)]), (_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.numberOfPages, page => {\n    return _openBlock(), _createElementBlock(\"li\", {\n      class: _normalizeClass([\"page-item\", $setup.currentPage === page ? 'active' : '']),\n      key: page\n    }, [_createElementVNode(\"a\", {\n      class: \"page-link\",\n      href: \"#\",\n      onClick: $event => $setup.getTodos(page)\n    }, _toDisplayString(page), 9\n    /* TEXT, PROPS */\n    , _hoisted_9)], 2\n    /* CLASS */\n    );\n  }), 128\n  /* KEYED_FRAGMENT */\n  )), _createElementVNode(\"li\", _hoisted_10, [$setup.currentPage != $setup.numberOfPages ? (_openBlock(), _createElementBlock(\"a\", {\n    key: 0,\n    class: \"page-link\",\n    href: \"#\",\n    onClick: _cache[4] || (_cache[4] = $event => $setup.getTodos($setup.currentPage + 1))\n  }, \"Next\")) : _createCommentVNode(\"v-if\", true)])])]), _createVNode(_Transition, {\n    name: \"hook\"\n  }, {\n    default: _withCtx(() => [$setup.showToast ? (_openBlock(), _createBlock(_component_Toast, {\n      key: 0,\n      message: $setup.toastMessage,\n      type: $setup.toastAlertType\n    }, null, 8\n    /* PROPS */\n    , [\"message\", \"type\"])) : _createCommentVNode(\"v-if\", true)]),\n    _: 1\n    /* STABLE */\n\n  })]);\n}","map":{"version":3,"mappings":";;;;;AAESA,OAAK,EAAC;;;gEACTC,oBAAmB,IAAnB,EAAmB,IAAnB,EAAI,YAAJ,EAAc;AAAA;AAAd;;gEAWFA,oBAAI,IAAJ,EAAI,IAAJ,EAAI,IAAJ,EAAI;AAAA;AAAJ;;;;;;gEAKAA,oBAAI,IAAJ,EAAI,IAAJ,EAAI,IAAJ,EAAI;AAAA;AAAJ;;;AACK,gBAAW;;;AACVD,OAAK,EAAC;;;AACJA,OAAK,EAAC;;;;AAENA,OAAK,EAAC;;;;;;;uBAvBhBE,oBA6BM,KA7BN,EA6BM,IA7BN,EA6BM,CA5BJD,oBAGM,KAHN,cAGM,CAFJE,UAEI,EADJF,oBAA0E,QAA1E,EAA0E;AAAlED,SAAK,EAAC,iBAA4D;AAAzCI,WAAK,yCAAEC,mDAAF;AAAoC,GAA1E,EAAsD,aAAtD,CACI,CAHN,CA4BI,kBAvBJJ,oBAMC,OAND,EAMC;AALGD,SAAK,EAAC,cAKT;AAJGM,QAAI,EAAC,MAIR;+DAHYD,oBAAUE,OAGtB;AAFGC,eAAW,EAAC,QAEf;AADIC,WAAK,mDAAQJ,iDAAR,EAAmB,SAAnB;AACT,GAND;;AAAA,oBAGaA,oBAoBT,EAhBJK,UAgBI,GAfQL,aAAMM,wBAAlBT,oBAEM,KAFN,EAEMU,UAFN,EAA0B,oBAA1B,sCAeI,EAZJC,aAA8EC,mBAA9E,EAA8E;AAAnEC,SAAK,EAAEV,YAA4D;AAApDW,gBAAW,EAAEX,iBAAuC;AAA1BY,gBAAW,EAAEZ;AAAa,GAA9E;;AAAA,8CAYI,EAXJa,UAWI,EAVJjB,oBAMM,KANN,cAMM,CALJA,oBAIK,IAJL,cAIK,CAHHA,oBAA4H,IAA5H,cAA4H,CAAlEI,sBAAW,mBAA/CH,oBAAiG,GAAjG,EAAiG;UAAA;AAA9FF,SAAK,EAAC,WAAwF;AAA5EmB,QAAI,EAAC,GAAuE;AAA5Cf,WAAK,sCAAEC,gBAASA,qBAAW,CAApB,CAAF;AAAuC,GAAjG,EAAqF,UAArF,sCAAsG,CAA5H,CAGG,qBAFHH,oBAAmLkB,SAAnL,EAAmL,IAAnL,EAAmLC,YAA9IhB,oBAA8I,EAAtJiB,IAAqB,IAAjB;yBAAjCpB,oBAAmL,IAAnL,EAAmL;AAA/KF,WAAK,mBAAC,WAAD,EAA+DK,uBAAciB,IAAd,GAAkB,QAAlB,GAAkB,EAAjF,EAA0K;AAA9HC,SAAG,EAAED;AAAyH,KAAnL,GAA4GrB,oBAAkE,GAAlE,EAAkE;AAA/DD,WAAK,EAAC,WAAyD;AAA7CmB,UAAI,EAAC,GAAwC;AAAnCf,aAAK,YAAEC,gBAASiB,IAAT;AAA4B,KAAlE,mBAAwDA,KAAxD,EAA4D;AAAA;AAA5D,MAA4DE,UAA5D,EAA5G;;AAAA;GAAmL,CAAnL;;AAAA,GAEG,GADHvB,oBAAoI,IAApI,eAAoI,CAA1EI,sBAAaA,sCAAjDH,oBAAyG,GAAzG,EAAyG;UAAA;AAAtGF,SAAK,EAAC,WAAgG;AAApFmB,QAAI,EAAC,GAA+E;AAAxCf,WAAK,sCAAEC,gBAASA,qBAAW,CAApB,CAAF;AAAmC,GAAzG,EAAiG,MAAjG,sCAA8G,CAApI,CACG,CAJL,CAKI,CANN,CAUI,EAHJQ,aAEaY,WAFb,EAEa;AAFDC,QAAI,EAAC;AAEJ,GAFb,EAAuB;sBACrB,MAAwE,CAA3DrB,kCAAbsB,aAAwEC,gBAAxE,EAAwE;YAAA;AAA/CC,aAAO,EAAExB,mBAAsC;AAAvBC,UAAI,EAAED;AAAiB,KAAxE;;AAAA,+DAAwE,EADnD;;;;AAAA,GAAvB,CAGI,CA7BN","names":["class","_createElementVNode","_createElementBlock","_hoisted_2","onClick","$setup","type","$event","placeholder","onKeyup","_hoisted_3","length","_hoisted_4","_createVNode","_component_TodoList","todos","onToggleTodo","onDeleteTodo","_hoisted_5","href","_Fragment","_renderList","page","key","_hoisted_9","_Transition","name","_createBlock","_component_Toast","message"],"sourceRoot":"","sources":["/Applications/kdh3543/vue_practice1/src/pages/todos/index.vue"],"sourcesContent":["<template>\n  <div>\n    <div class=\"d-flex justify-content-between mb-3\">\n      <h1>To-Do List</h1>\n      <button class=\"btn btn-primary\" @click=\"moveToCreate\">Create Todo</button>\n    </div>\n    \n    <input\n        class=\"form-control\"\n        type=\"text\" \n        v-model=\"searchText\"\n        placeholder=\"search\"\n        @keyup.enter=\"searchClear\"\n    >\n    <hr>\n    <div v-if=\"!todos.length\">\n      There is nothing\n    </div>\n    <TodoList :todos=\"todos\" @toggle-todo=\"toggleTodo\" @delete-todo=\"deleteTodo\"/>\n    <hr>\n    <nav aria-label=\"Page navigation example\">\n      <ul class=\"pagination\">\n        <li class=\"page-item\"><a class=\"page-link\" href=\"#\" v-if=\"currentPage!=1\" @click=\"getTodos(currentPage-1)\">Previous</a></li>\n        <li class=\"page-item\" v-for=\"page in numberOfPages\" :key=\"page\" :class=\"currentPage===page ? 'active' : ''\"><a class=\"page-link\" href=\"#\" @click=\"getTodos(page)\">{{page}}</a></li>\n        <li class=\"page-item\"><a class=\"page-link\" href=\"#\" v-if=\"currentPage!=numberOfPages\" @click=\"getTodos(currentPage+1)\">Next</a></li>\n      </ul>\n    </nav>\n    <transition name=\"hook\">\n      <Toast v-if=\"showToast\" :message=\"toastMessage\" :type=\"toastAlertType\"/>\n    </transition>\n  </div>\n</template>\n\n<script>\nimport { ref, computed, watch} from 'vue';\nimport TodoList from '@/components/TodoList.vue';\nimport axios from 'axios';\nimport Toast from '@/components/Toast.vue';\nimport {useToast} from '@/hooks/toast';\nimport {useRouter} from 'vue-router';\n\nexport default {\n  components: {\n    TodoList,\n    Toast\n  },\n  setup() {\n    const router = useRouter();\n    const todos = ref([]);\n    const error = ref('');\n    const numberOfTodos = ref(0);\n    const currentPage = ref(1);\n    const limit = 5;\n    const searchText = ref('');\n\n    const{\n      toastMessage,\n      toastAlertType,\n      showToast,\n      triggerToast\n    } = useToast();\n\n    const numberOfPages = computed(() => {\n      return Math.ceil(numberOfTodos.value/limit);\n    })\n\n    const addTodo = async (todo) => {\n      try{\n        await axios.post('http://localhost:3000/todos',{\n          subject: todo.subject,\n          completed: todo.completed,\n        });\n        getTodos(1);\n      }catch(err){\n        error.value = err;\n        triggerToast('error','danger');\n      } \n      // .then(res => {\n      //   todos.value.push(res.data);\n      // }).catch(err => {\n      //   \n      // });\n    };\n    \n    const getTodos = async(page = currentPage.value) => {\n      currentPage.value = page;\n      try{\n        const res = await axios.get(`http://localhost:3000/todos?_sort=id&_order=desc&subject_like=${searchText.value}&_page=${page}&_limit=${limit}`)\n        numberOfTodos.value = res.headers['x-total-count'];\n        todos.value = res.data;\n      }catch(err){\n        error.value = err;\n        triggerToast('error','danger');\n      }      \n    }\n    getTodos();\n\n    const toggleTodo = async (index,checked) => {\n      const id = todos.value[index].id;\n      try{\n        await axios.patch('http://localhost:3000/todos/'+id,{\n          completed: checked\n        });\n        todos.value[index].completed = checked;\n      }catch(err){\n        error.value = err;\n        triggerToast('error','danger');\n      }\n    };\n\n    const deleteTodo = async (index) => {\n      const id = todos.value[index].id;\n      try{\n        \n        await axios.delete('http://localhost:3000/todos/'+id);\n        getTodos(1);\n        error.value = '';\n      }catch(err){\n        error.value = err;\n        triggerToast('error','danger');\n      }      \n    };\n\n    //watch를 사용하여 검색\n    let timeout = null;\n    const searchClear = () => {\n      getTodos(1);\n    };\n    watch(searchText, () => {\n      clearTimeout(timeout);\n      timeout = setTimeout(() => {\n        getTodos(1);\n      },1000)\n    })\n\n    const moveToCreate = () => {\n      router.push({\n        name: 'TodoCreate'\n      })\n    }\n\n    return {\n      todos,\n      addTodo,\n      deleteTodo,\n      toggleTodo,\n      searchText,\n      // filteredTodos,\n      error,\n      getTodos,\n      numberOfPages,\n      currentPage,\n      searchClear,\n      showToast,\n      toastMessage,\n      toastAlertType,\n      triggerToast,\n      moveToCreate\n    };\n  }\n}\n</script>\n\n<style scoped>\n  .todo {\n    color: gray;\n    text-decoration: line-through;\n  }\n  .hook-enter-active, .hook-leave-active\n  {\n    transition: opacity 0.5s ease;\n  }\n  .hook-enter-from, .hook-leave-to\n  {\n    opacity: 0;\n    transform: translateY(-30px);\n  }\n\n  .hook-enter-to, .hook-leave-from{\n    opacity: 1;\n    transform: translateY(0px);\n  }\n  \n</style>"]},"metadata":{},"sourceType":"module"}