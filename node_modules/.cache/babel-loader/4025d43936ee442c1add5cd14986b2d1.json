{"ast":null,"code":"import { ref, computed, watch } from 'vue';\nimport TodoList from '@/components/TodoList.vue';\nimport axios from 'axios';\nimport Toast from '@/components/Toast.vue';\nimport { useToast } from '@/composables/toast';\nimport { useRouter } from 'vue-router';\nexport default {\n  components: {\n    TodoList,\n    Toast\n  },\n\n  setup() {\n    const router = useRouter();\n    const todos = ref([]);\n    const error = ref('');\n    const numberOfTodos = ref(0);\n    let limit = 5;\n    const currentPage = ref(1);\n    const searchText = ref('');\n    const numberOfPages = computed(() => {\n      return Math.ceil(numberOfTodos.value / limit);\n    });\n    const {\n      toastMessage,\n      toastAlertType,\n      showToast,\n      triggerToast\n    } = useToast();\n\n    const getTodos = async (page = currentPage.value) => {\n      currentPage.value = page;\n\n      try {\n        const res = await axios.get(`http://localhost:3000/todos?_sort=id&_order=desc&subject_like=${searchText.value}&_page=${page}&_limit=${limit}`);\n        numberOfTodos.value = res.headers['x-total-count'];\n        todos.value = res.data;\n      } catch (err) {\n        console.log(err);\n        error.value = 'Something went wrong.';\n        triggerToast('Something went wrong', 'danger');\n      }\n    };\n\n    getTodos();\n\n    const addTodo = async todo => {\n      // 데이터베이스 투두를 저장\n      error.value = '';\n\n      try {\n        await axios.post('http://localhost:3000/todos', {\n          subject: todo.subject,\n          completed: todo.completed\n        });\n        getTodos(1);\n      } catch (err) {\n        console.log(err);\n        error.value = 'Something went wrong.';\n        triggerToast('Something went wrong', 'danger');\n      }\n    };\n\n    const deleteTodo = async id => {\n      error.value = '';\n\n      try {\n        await axios.delete('http://localhost:3000/todos/' + id);\n        getTodos(1);\n      } catch (err) {\n        console.log(err);\n        error.value = 'Something went wrong.';\n        triggerToast('Something went wrong', 'danger');\n      }\n    };\n\n    const toggleTodo = async (index, checked) => {\n      error.value = '';\n      const id = todos.value[index].id;\n\n      try {\n        await axios.patch('http://localhost:3000/todos/' + id, {\n          completed: checked\n        });\n        todos.value[index].completed = checked;\n      } catch (err) {\n        console.log(err);\n        error.value = 'Something went wrong.';\n        triggerToast('Something went wrong', 'danger');\n      }\n    };\n\n    const moveToCreatePage = () => {\n      router.push({\n        name: 'TodoCreate'\n      });\n    };\n\n    let timeout = null;\n\n    const searchTodo = () => {\n      clearTimeout(timeout);\n      getTodos(1);\n    };\n\n    watch(searchText, () => {\n      clearTimeout(timeout);\n      timeout = setTimeout(() => {\n        getTodos(1);\n      }, 2000);\n    });\n    return {\n      searchTodo,\n      todos,\n      addTodo,\n      deleteTodo,\n      toggleTodo,\n      searchText,\n      error,\n      numberOfPages,\n      currentPage,\n      getTodos,\n      toastMessage,\n      toastAlertType,\n      showToast,\n      moveToCreatePage\n    };\n  }\n\n};","map":{"version":3,"mappings":"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","names":["ref","computed","watch","TodoList","axios","Toast","useToast","useRouter","components","setup","router","todos","error","numberOfTodos","limit","currentPage","searchText","numberOfPages","Math","ceil","value","toastMessage","toastAlertType","showToast","triggerToast","getTodos","page","res","get","headers","data","err","console","log","addTodo","todo","post","subject","completed","deleteTodo","id","delete","toggleTodo","index","checked","patch","moveToCreatePage","push","name","timeout","searchTodo","clearTimeout","setTimeout"],"sourceRoot":"","sources":["/Applications/kdh3543/vue_practice1/src/pages/todos/index.vue"],"sourcesContent":["<template>\n  <div>\n    <div class=\"d-flex justify-content-between mb-3\">\n      <h2>To-Do List</h2>\n      <button \n        class=\"btn btn-primary\"\n        @click=\"moveToCreatePage\"\n      >\n        Create Todo\n      </button>\n    </div>\n    \n    <input\n      class=\"form-control\"\n      type=\"text\" \n      v-model=\"searchText\"\n      placeholder=\"Search\"\n      @keyup.enter=\"searchTodo\"\n    >\n    <hr />\n    \n    <div v-if=\"!todos.length\">\n      There is nothing to display\n    </div>\n    <TodoList \n      :todos=\"todos\" \n      @toggle-todo=\"toggleTodo\"\n      @delete-todo=\"deleteTodo\"\n    />\n    <hr />\n    <nav aria-label=\"Page navigation example\">\n      <ul class=\"pagination\">\n        <li v-if=\"currentPage !== 1\" class=\"page-item\">\n          <a style=\"cursor: pointer\" class=\"page-link\" @click=\"getTodos(currentPage - 1)\">\n            Previous\n          </a>\n        </li>\n        <li\n          v-for=\"page in numberOfPages\"\n          :key=\"page\" \n          class=\"page-item\"\n          :class=\"currentPage === page ? 'active' : ''\"\n        >\n          <a style=\"cursor: pointer\" class=\"page-link\" @click=\"getTodos(page)\">{{page}}</a>\n        </li>\n        <li v-if=\"numberOfPages !== currentPage\" class=\"page-item\">\n          <a style=\"cursor: pointer\" class=\"page-link\" @click=\"getTodos(currentPage + 1)\">Next</a>\n        </li>\n      </ul>\n    </nav>\n  </div>\n  <Toast \n    v-if=\"showToast\" \n    :message=\"toastMessage\"\n    :type=\"toastAlertType\"\n  />\n</template>\n\n<script>\nimport { ref, computed, watch } from 'vue';\nimport TodoList from '@/components/TodoList.vue';\nimport axios from 'axios';\nimport Toast from '@/components/Toast.vue';\nimport { useToast } from '@/composables/toast';\nimport {useRouter} from 'vue-router';\n\nexport default {\n  components: {\n    TodoList,\n    Toast,\n  },\n  setup() {\n    const router = useRouter();\n    const todos = ref([]);\n    const error = ref('');\n    const numberOfTodos = ref(0);\n    let limit = 5;\n    const currentPage = ref(1);\n    const searchText = ref('');\n    const numberOfPages = computed(() => {\n      return Math.ceil(numberOfTodos.value/limit);\n    });\n\n    const {\n      toastMessage,\n      toastAlertType,\n      showToast,\n      triggerToast\n    } = useToast();\n\n    const getTodos = async (page = currentPage.value) => {\n      currentPage.value = page;\n      try {\n        const res = await axios.get(\n          `http://localhost:3000/todos?_sort=id&_order=desc&subject_like=${searchText.value}&_page=${page}&_limit=${limit}`\n        );\n        numberOfTodos.value = res.headers['x-total-count'];\n        todos.value = res.data;\n      } catch (err) {\n        console.log(err);\n        error.value = 'Something went wrong.';\n        triggerToast('Something went wrong', 'danger')\n      }    \n    };\n\n    getTodos();\n\n    const addTodo = async (todo) => {\n      // 데이터베이스 투두를 저장\n      error.value = '';\n      try {\n        await axios.post('http://localhost:3000/todos', {\n          subject: todo.subject,\n          completed: todo.completed,\n        });\n\n        getTodos(1);\n      } catch (err) {\n        console.log(err);\n        error.value = 'Something went wrong.';\n        triggerToast('Something went wrong', 'danger')\n      }\n    };\n\n    const deleteTodo = async (id) => {\n      error.value = '';\n    \n      try {\n        await axios.delete('http://localhost:3000/todos/' + id);\n        \n        getTodos(1);\n      } catch (err) {\n        console.log(err);\n        error.value = 'Something went wrong.';\n        triggerToast('Something went wrong', 'danger')\n      }\n    };\n\n    const toggleTodo = async (index, checked) => {\n      error.value = '';\n      const id = todos.value[index].id;\n      try {\n        await axios.patch('http://localhost:3000/todos/' + id, {\n          completed: checked\n        });\n\n        todos.value[index].completed = checked\n      } catch (err) {\n        console.log(err);\n        error.value = 'Something went wrong.';\n        triggerToast('Something went wrong', 'danger')\n      }\n      \n    };\n\n    const moveToCreatePage = () => {\n      router.push({\n        name: 'TodoCreate',\n      })\n    };\n\n    let timeout = null;\n    const searchTodo = () => {\n      clearTimeout(timeout);\n      getTodos(1);\n    };\n\n    watch(searchText, () => {\n      clearTimeout(timeout);\n      timeout = setTimeout(() => {\n        getTodos(1);\n      }, 2000);     \n    });\n\n    return {\n      searchTodo,\n      todos,\n      addTodo,\n      deleteTodo,\n      toggleTodo,\n      searchText,\n      error,\n      numberOfPages,\n      currentPage,\n      getTodos,\n      toastMessage,\n      toastAlertType,\n      showToast,\n      moveToCreatePage,\n    };\n  }\n}\n</script>\n\n<style>\n  .todo {\n    color: gray;\n    text-decoration: line-through;\n  }\n</style>"]},"metadata":{},"sourceType":"module"}